// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider      = "prisma-client-js"
  binaryTargets = ["native", "linux-arm64-openssl-1.1.x", "linux-arm64-openssl-3.0.x"]
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Object {
  id         Int      @id @default(autoincrement())
  name       String
  snapshotId Int      @map("snapshot_id")
  snapshot   Snapshot @relation(fields: [snapshotId], references: [id])
  blob       String?  @map("bytea")

  @@map("objects")
}

model Snapshot {
  id          Int        @id @default(autoincrement())
  parentId    Int?       @map("parent_id")
  parent      Snapshot?  @relation("SnapshotToSnapshot", fields: [parentId], references: [id])
  children    Snapshot[] @relation("SnapshotToSnapshot")
  directoryId Int        @map("directory_id")
  directory   Directory  @relation(fields: [directoryId], references: [id])
  sequenceRef Int        @map("sequence_ref")
  objects     Object[]

  @@map("snapshots")
}

model Directory {
  id        Int        @id @default(autoincrement())
  path      Int
  snapshots Snapshot[]

  @@map("directory")
}
